---
title: wtm血泪
author: wuxinheng
date: 2022-07-22 22:52:32
description: 我们做了什么？
tags:
- wtm
categories:
- dotnet
---

## 前言

最开始是领导推荐。具体使用之后会感觉wtm好像孙悟空用金箍棒给唐僧画的圈。也可能是之前写代码随意惯了。突然这样倒是有点像叛逆的少年觉得这个框架不怎么样。后面我们也写了很多功能。我去了解源码。突然觉的这个框架越用越香。我们实在21年冬天开始使用时并没有多租户。但是在阅读源码时发现竟然有TenantCode的存在。可能那个时候wtm已经在规划多租户了。

可能我们遇见wtm不是在最好的时候吧。我们就利用wtm来做了一个多租户的项目，使用共享数据库的方式来实现。本来领导已经实现好了，今年突然发现个乌龙。项目确实可以通过租户id来进行过滤，但是登录另一个租户时服务器的租户id被更新掉了。因为这里是通过单例来存贮租户id的。还好项目还没上线

悲伤的故事就这样开始了,我开始参照wtm新版本的多租户开始改造项目，为了记录这个过程。我写了wtm源码解读其实也就一点点源码，冰山一角。

ps:一部分源码是之前的版本，新版本代码我会说明

